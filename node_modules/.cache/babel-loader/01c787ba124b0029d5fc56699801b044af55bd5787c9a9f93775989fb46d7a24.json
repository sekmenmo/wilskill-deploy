{"ast":null,"code":"var _jsxFileName = \"/Users/mertsekmen/Desktop/wilskills-event-webapp/wilskill-app/src/Pages/SignIn.jsx\",\n  _s = $RefreshSig$();\nimport React from \"react\";\nimport { GoogleButton } from \"react-google-button\";\nimport { UserAuth } from \"../context/AuthContext\";\nimport { getAuth, onAuthStateChanged } from \"firebase/auth\";\nimport { stringWrapper } from \"./stringWrapper\";\nimport { useFetch } from \"../Pages/useFetch\";\nimport { useNavigate, Navigate } from \"react-router-dom\";\nimport { useEffect } from \"react\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Signin = () => {\n  _s();\n  let {\n    googleSignIn,\n    user\n  } = UserAuth();\n  const navigate = useNavigate();\n  let {\n    data: sqlUserData\n  } = useFetch(`http://localhost:3001/users/get/`);\n  const handleGoogleSignIn = async () => {\n    try {\n      await googleSignIn();\n    } catch (error) {\n      console.log(error);\n    }\n  };\n  useEffect(() => {\n    console.log(sqlUserData);\n    const auth = getAuth();\n    onAuthStateChanged(auth, user => {\n      //FIXME: In the use effect, SQL user data clears, why?\n      //FIXME: Don't do post call when user is already in table\n      if (user) {\n        const curUser = sqlUserData.filter(u => u.firebase_ID == user.uid);\n        if (curUser.length === 0) {\n          console.log(curUser);\n          axios.post(\"http://localhost:3001/users/adduser\", {\n            namePronouns: stringWrapper(user.displayName),\n            email: stringWrapper(user.email),\n            firebaseID: stringWrapper(user.uid)\n          }).then(async res => {\n            if (res) {\n              console.log(res);\n            }\n          }).catch(error => {\n            console.log(error);\n          });\n        }\n        navigate(\"/account\");\n      }\n    });\n  }, [user]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"text-center text-2xl font-bold py-4\",\n      children: \"Sign-in\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"max-w-[240px] m-auto py-4\",\n      children: /*#__PURE__*/_jsxDEV(GoogleButton, {\n        onClick: handleGoogleSignIn\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 55,\n    columnNumber: 5\n  }, this);\n};\n_s(Signin, \"1/dK6HrgRrxXhyee0bLehlj7m6k=\", false, function () {\n  return [useNavigate, useFetch];\n});\n_c = Signin;\nexport default Signin;\nvar _c;\n$RefreshReg$(_c, \"Signin\");","map":{"version":3,"names":["React","GoogleButton","UserAuth","getAuth","onAuthStateChanged","stringWrapper","useFetch","useNavigate","Navigate","useEffect","axios","Signin","googleSignIn","user","navigate","data","sqlUserData","handleGoogleSignIn","error","console","log","auth","curUser","filter","u","firebase_ID","uid","length","post","namePronouns","displayName","email","firebaseID","then","res","catch"],"sources":["/Users/mertsekmen/Desktop/wilskills-event-webapp/wilskill-app/src/Pages/SignIn.jsx"],"sourcesContent":["import React from \"react\";\nimport { GoogleButton } from \"react-google-button\";\nimport { UserAuth } from \"../context/AuthContext\";\nimport { getAuth, onAuthStateChanged } from \"firebase/auth\";\nimport { stringWrapper } from \"./stringWrapper\";\nimport { useFetch } from \"../Pages/useFetch\";\nimport { useNavigate, Navigate } from \"react-router-dom\";\nimport { useEffect } from \"react\";\nimport axios from \"axios\";\n\nconst Signin = () => {\n  let { googleSignIn, user } = UserAuth();\n  const navigate = useNavigate();\n  let { data: sqlUserData } = useFetch(`http://localhost:3001/users/get/`);\n  \n\n  const handleGoogleSignIn = async () => {\n    try {\n      await googleSignIn();\n    } catch (error) {\n      console.log(error);\n    }\n  };\n  useEffect(() => {\n    console.log(sqlUserData);\n    const auth = getAuth();\n    onAuthStateChanged(auth, (user) => {\n      //FIXME: In the use effect, SQL user data clears, why?\n      //FIXME: Don't do post call when user is already in table\n    if (user) {\n      const curUser = sqlUserData.filter(u => u.firebase_ID == user.uid)\n      if(curUser.length === 0){\n        console.log(curUser)\n        axios.post(\"http://localhost:3001/users/adduser\", {\n            namePronouns: stringWrapper(user.displayName),\n            email: stringWrapper(user.email),\n            firebaseID: stringWrapper(user.uid)\n        })\n          .then(async (res) => {\n            if (res) {\n              console.log(res);\n            }\n          })\n          .catch((error) => {\n            console.log(error);\n          });\n    \n      }\n      navigate(\"/account\");\n    }\n    })\n  }, [user]);\n\n  return (\n    <div>\n      <h1 className=\"text-center text-2xl font-bold py-4\">Sign-in</h1>\n      <div className=\"max-w-[240px] m-auto py-4\">\n        <GoogleButton onClick={handleGoogleSignIn} />\n      </div>\n    </div>\n  );\n};\n\nexport default Signin;\n"],"mappings":";;AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,YAAY,QAAQ,qBAAqB;AAClD,SAASC,QAAQ,QAAQ,wBAAwB;AACjD,SAASC,OAAO,EAAEC,kBAAkB,QAAQ,eAAe;AAC3D,SAASC,aAAa,QAAQ,iBAAiB;AAC/C,SAASC,QAAQ,QAAQ,mBAAmB;AAC5C,SAASC,WAAW,EAAEC,QAAQ,QAAQ,kBAAkB;AACxD,SAASC,SAAS,QAAQ,OAAO;AACjC,OAAOC,KAAK,MAAM,OAAO;AAAC;AAE1B,MAAMC,MAAM,GAAG,MAAM;EAAA;EACnB,IAAI;IAAEC,YAAY;IAAEC;EAAK,CAAC,GAAGX,QAAQ,EAAE;EACvC,MAAMY,QAAQ,GAAGP,WAAW,EAAE;EAC9B,IAAI;IAAEQ,IAAI,EAAEC;EAAY,CAAC,GAAGV,QAAQ,CAAE,kCAAiC,CAAC;EAGxE,MAAMW,kBAAkB,GAAG,YAAY;IACrC,IAAI;MACF,MAAML,YAAY,EAAE;IACtB,CAAC,CAAC,OAAOM,KAAK,EAAE;MACdC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC;IACpB;EACF,CAAC;EACDT,SAAS,CAAC,MAAM;IACdU,OAAO,CAACC,GAAG,CAACJ,WAAW,CAAC;IACxB,MAAMK,IAAI,GAAGlB,OAAO,EAAE;IACtBC,kBAAkB,CAACiB,IAAI,EAAGR,IAAI,IAAK;MACjC;MACA;MACF,IAAIA,IAAI,EAAE;QACR,MAAMS,OAAO,GAAGN,WAAW,CAACO,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACC,WAAW,IAAIZ,IAAI,CAACa,GAAG,CAAC;QAClE,IAAGJ,OAAO,CAACK,MAAM,KAAK,CAAC,EAAC;UACtBR,OAAO,CAACC,GAAG,CAACE,OAAO,CAAC;UACpBZ,KAAK,CAACkB,IAAI,CAAC,qCAAqC,EAAE;YAC9CC,YAAY,EAAExB,aAAa,CAACQ,IAAI,CAACiB,WAAW,CAAC;YAC7CC,KAAK,EAAE1B,aAAa,CAACQ,IAAI,CAACkB,KAAK,CAAC;YAChCC,UAAU,EAAE3B,aAAa,CAACQ,IAAI,CAACa,GAAG;UACtC,CAAC,CAAC,CACCO,IAAI,CAAC,MAAOC,GAAG,IAAK;YACnB,IAAIA,GAAG,EAAE;cACPf,OAAO,CAACC,GAAG,CAACc,GAAG,CAAC;YAClB;UACF,CAAC,CAAC,CACDC,KAAK,CAAEjB,KAAK,IAAK;YAChBC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC;UACpB,CAAC,CAAC;QAEN;QACAJ,QAAQ,CAAC,UAAU,CAAC;MACtB;IACA,CAAC,CAAC;EACJ,CAAC,EAAE,CAACD,IAAI,CAAC,CAAC;EAEV,oBACE;IAAA,wBACE;MAAI,SAAS,EAAC,qCAAqC;MAAA,UAAC;IAAO;MAAA;MAAA;MAAA;IAAA,QAAK,eAChE;MAAK,SAAS,EAAC,2BAA2B;MAAA,uBACxC,QAAC,YAAY;QAAC,OAAO,EAAEI;MAAmB;QAAA;QAAA;QAAA;MAAA;IAAG;MAAA;MAAA;MAAA;IAAA,QACzC;EAAA;IAAA;IAAA;IAAA;EAAA,QACF;AAEV,CAAC;AAAC,GAnDIN,MAAM;EAAA,QAEOJ,WAAW,EACAD,QAAQ;AAAA;AAAA,KAHhCK,MAAM;AAqDZ,eAAeA,MAAM;AAAC;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}